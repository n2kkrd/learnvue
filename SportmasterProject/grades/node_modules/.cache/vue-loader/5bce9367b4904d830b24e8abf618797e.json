{"remainingRequest":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\src\\components\\grade\\StudentChart.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\src\\components\\grade\\StudentChart.vue","mtime":1684148396657},{"path":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684148679318},{"path":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\node_modules\\babel-loader\\lib\\index.js","mtime":1684148680274},{"path":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684148679318},{"path":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\node_modules\\vue-loader\\lib\\index.js","mtime":1684148680698}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgQ2hhcnQgZnJvbSAnY2hhcnQuanMvYXV0bycNCg0KZXhwb3J0IGRlZmF1bHQgew0KbmFtZTogJ1N0dWRlbnRDaGFydCcsDQpkYXRhICgpIHsNCiAgcmV0dXJuIHsNCiAgICBwaWVDaGFydDogbnVsbCwNCiAgICBiYXJDaGFydDogbnVsbCwNCiAgfQ0KfSwNCmFzeW5jIGNyZWF0ZWQgKCkgew0KICBhd2FpdCB0aGlzLmxvYWREYXRhKCkNCg0KfSwNCmNvbXB1dGVkOiB7DQogIGNoYXJ0RGF0YTogZnVuY3Rpb24gKCkgew0KICAgIGNvbnN0IGdyYWRlQ291bnRzID0ge30NCiAgICBjb25zdCBzdHVkZW50c0J5R3JhZGUgPSB7fQ0KICAgIHRoaXMuJHN0b3JlLnN0YXRlLmdyYWRlLmdyYWRlcy5mb3JFYWNoKChncmFkZSkgPT4gew0KICAgICAgY29uc3QgZ3JhZGVWYWx1ZSA9IGdyYWRlLmdyYWRlDQogICAgICBpZiAoIWdyYWRlQ291bnRzW2dyYWRlVmFsdWVdKSB7DQogICAgICAgIGdyYWRlQ291bnRzW2dyYWRlVmFsdWVdID0gMA0KICAgICAgICBzdHVkZW50c0J5R3JhZGVbZ3JhZGVWYWx1ZV0gPSBbXQ0KICAgICAgfQ0KICAgICAgZ3JhZGVDb3VudHNbZ3JhZGVWYWx1ZV0rKw0KICAgICAgc3R1ZGVudHNCeUdyYWRlW2dyYWRlVmFsdWVdLnB1c2godGhpcy4kc3RvcmUuc3RhdGUuc3R1ZGVudC5zdHVkZW50cy5nZXQoZ3JhZGUuc3R1ZGVudENvZGUpKQ0KICAgIH0pDQoNCiAgICByZXR1cm4gT2JqZWN0LmVudHJpZXMoZ3JhZGVDb3VudHMpLm1hcCgoW2dyYWRlVmFsdWUsIGNvdW50XSkgPT4gKHsNCiAgICAgIGdyYWRlVmFsdWUsDQogICAgICBjb3VudCwNCiAgICAgIHN0dWRlbnRzOiBzdHVkZW50c0J5R3JhZGVbZ3JhZGVWYWx1ZV0sDQogICAgfSkpDQogIH0sDQogIGNoYXJ0RGF0YUFuZE9wdGlvbnM6IGZ1bmN0aW9uICgpIHsNCiAgICBjb25zdCBjaGFydERhdGEgPSB0aGlzLmNoYXJ0RGF0YQ0KICAgIGNvbnN0IGRhdGEgPSB7DQogICAgICBsYWJlbHM6IGNoYXJ0RGF0YS5tYXAoKGdyYWRlKSA9PiBncmFkZS5ncmFkZVZhbHVlKSwNCiAgICAgIGRhdGFzZXRzOiBbDQogICAgICAgIHsNCiAgICAgICAgICBkYXRhOiBjaGFydERhdGEubWFwKChncmFkZSkgPT4gZ3JhZGUuY291bnQpLA0KICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogWw0KICAgICAgICAgICAgJyNGRjYzODQnLA0KICAgICAgICAgICAgJyMzNkEyRUInLA0KICAgICAgICAgICAgJyNGRkNFNTYnLA0KICAgICAgICAgICAgJyM4REZGMDAnLA0KICAgICAgICAgICAgJyNGRjU3MzMnLA0KICAgICAgICAgICAgJyNDNDFFM0QnLA0KICAgICAgICAgIF0sDQogICAgICAgIH0sDQogICAgICBdLA0KICAgIH0NCiAgICBjb25zdCBvcHRpb25zID0gew0KICAgICAgcmVzcG9uc2l2ZTogdHJ1ZSwNCiAgICAgIG1haW50YWluQXNwZWN0UmF0aW86IGZhbHNlLA0KICAgICAgcGx1Z2luczogew0KICAgICAgICB0b29sdGlwOiB7DQogICAgICAgICAgY2FsbGJhY2tzOiB7DQogICAgICAgICAgICBsYWJlbDogZnVuY3Rpb24gKHRvb2x0aXBJdGVtKSB7DQogICAgICAgICAgICAgIGNvbnN0IGFycmF5ID0gY2hhcnREYXRhW3Rvb2x0aXBJdGVtLmRhdGFJbmRleF0uc3R1ZGVudHMubWFwKCh7IGZ1bGxOYW1lIH0pID0+IGZ1bGxOYW1lKQ0KICAgICAgICAgICAgICBhcnJheS51bnNoaWZ0KHRvb2x0aXBJdGVtLnJhdykNCiAgICAgICAgICAgICAgcmV0dXJuIGFycmF5DQogICAgICAgICAgICB9DQogICAgICAgICAgfSwNCiAgICAgICAgfSwNCiAgICAgIH0NCiAgICB9DQoNCiAgICByZXR1cm4geyBkYXRhLCBvcHRpb25zIH0NCiAgfQ0KfSwNCm1ldGhvZHM6IHsNCiAgYXN5bmMgbG9hZERhdGEgKCkgew0KICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdzdHVkZW50L2dldFN0dWRlbnRzJykNCiAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ3JhZGUvZ2V0Q291cnNlcycpDQogICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2dyYWRlL2dldEdyYWRlcycpDQoNCiAgICB0aGlzLmNyZWF0ZVBpZUNoYXJ0KCkNCiAgICB0aGlzLmNyZWF0ZUJhckNoYXJ0KCkNCiAgfSwNCg0KICBjcmVhdGVQaWVDaGFydCAoKSB7DQogICAgdGhpcy5waWVDaGFydCA9IG5ldyBDaGFydCh0aGlzLiRyZWZzLnBpZUNoYXJ0LCB7DQogICAgICB0eXBlOiAncGllJywNCiAgICAgIC4uLnRoaXMuY2hhcnREYXRhQW5kT3B0aW9ucywNCiAgICB9KQ0KICB9LA0KICBjcmVhdGVCYXJDaGFydCAoKSB7DQogICAgY29uc3QgeyBkYXRhLCBvcHRpb25zIH0gPSB0aGlzLmNoYXJ0RGF0YUFuZE9wdGlvbnMNCiAgICBvcHRpb25zLnBsdWdpbnMubGVnZW5kID0gew0KICAgICAgZGlzcGxheTogZmFsc2UNCiAgICB9DQogICAgdGhpcy5iYXJDaGFydCA9IG5ldyBDaGFydCh0aGlzLiRyZWZzLmJhckNoYXJ0LCB7DQogICAgICB0eXBlOiAnYmFyJywNCiAgICAgIGRhdGEsDQogICAgICBvcHRpb25zLA0KICAgIH0pDQogIH0sDQp9LA0KfQ0K"},{"version":3,"sources":["StudentChart.vue"],"names":[],"mappings":";AAwBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"StudentChart.vue","sourceRoot":"src/components/grade","sourcesContent":["<template>\r\n  <v-container>\r\n      <v-row>\r\n          <v-col cols=\"6\">\r\n              <v-card>\r\n                  <v-card-title>Круговая диаграмма распределения оценок</v-card-title>\r\n                  <v-card-text>\r\n                      <canvas ref=\"pieChart\" width=\"400\" height=\"400\"></canvas>\r\n                  </v-card-text>\r\n              </v-card>\r\n          </v-col>\r\n          <v-col cols=\"6\">\r\n              <v-card>\r\n                  <v-card-title>Столбчатая диаграмма распределения оценок по курсам</v-card-title>\r\n                  <v-card-text>\r\n                      <canvas ref=\"barChart\" width=\"400\" height=\"400\"></canvas>\r\n                  </v-card-text>\r\n              </v-card>\r\n          </v-col>\r\n      </v-row>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\nimport Chart from 'chart.js/auto'\r\n\r\nexport default {\r\nname: 'StudentChart',\r\ndata () {\r\n  return {\r\n    pieChart: null,\r\n    barChart: null,\r\n  }\r\n},\r\nasync created () {\r\n  await this.loadData()\r\n\r\n},\r\ncomputed: {\r\n  chartData: function () {\r\n    const gradeCounts = {}\r\n    const studentsByGrade = {}\r\n    this.$store.state.grade.grades.forEach((grade) => {\r\n      const gradeValue = grade.grade\r\n      if (!gradeCounts[gradeValue]) {\r\n        gradeCounts[gradeValue] = 0\r\n        studentsByGrade[gradeValue] = []\r\n      }\r\n      gradeCounts[gradeValue]++\r\n      studentsByGrade[gradeValue].push(this.$store.state.student.students.get(grade.studentCode))\r\n    })\r\n\r\n    return Object.entries(gradeCounts).map(([gradeValue, count]) => ({\r\n      gradeValue,\r\n      count,\r\n      students: studentsByGrade[gradeValue],\r\n    }))\r\n  },\r\n  chartDataAndOptions: function () {\r\n    const chartData = this.chartData\r\n    const data = {\r\n      labels: chartData.map((grade) => grade.gradeValue),\r\n      datasets: [\r\n        {\r\n          data: chartData.map((grade) => grade.count),\r\n          backgroundColor: [\r\n            '#FF6384',\r\n            '#36A2EB',\r\n            '#FFCE56',\r\n            '#8DFF00',\r\n            '#FF5733',\r\n            '#C41E3D',\r\n          ],\r\n        },\r\n      ],\r\n    }\r\n    const options = {\r\n      responsive: true,\r\n      maintainAspectRatio: false,\r\n      plugins: {\r\n        tooltip: {\r\n          callbacks: {\r\n            label: function (tooltipItem) {\r\n              const array = chartData[tooltipItem.dataIndex].students.map(({ fullName }) => fullName)\r\n              array.unshift(tooltipItem.raw)\r\n              return array\r\n            }\r\n          },\r\n        },\r\n      }\r\n    }\r\n\r\n    return { data, options }\r\n  }\r\n},\r\nmethods: {\r\n  async loadData () {\r\n    await this.$store.dispatch('student/getStudents')\r\n    await this.$store.dispatch('grade/getCourses')\r\n    await this.$store.dispatch('grade/getGrades')\r\n\r\n    this.createPieChart()\r\n    this.createBarChart()\r\n  },\r\n\r\n  createPieChart () {\r\n    this.pieChart = new Chart(this.$refs.pieChart, {\r\n      type: 'pie',\r\n      ...this.chartDataAndOptions,\r\n    })\r\n  },\r\n  createBarChart () {\r\n    const { data, options } = this.chartDataAndOptions\r\n    options.plugins.legend = {\r\n      display: false\r\n    }\r\n    this.barChart = new Chart(this.$refs.barChart, {\r\n      type: 'bar',\r\n      data,\r\n      options,\r\n    })\r\n  },\r\n},\r\n}\r\n</script>\r\n"]}]}