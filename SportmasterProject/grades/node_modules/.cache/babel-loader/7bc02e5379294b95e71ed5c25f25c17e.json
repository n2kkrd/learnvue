{"remainingRequest":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\src\\components\\grade\\StudentChart.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\src\\components\\grade\\StudentChart.vue","mtime":1684148396657},{"path":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\babel.config.js","mtime":1614328697185},{"path":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684148679318},{"path":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\node_modules\\babel-loader\\lib\\index.js","mtime":1684148680274},{"path":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684148679318},{"path":"C:\\Users\\n2kn2\\OneDrive\\Рабочий стол\\Projects\\learnvue\\SportmasterProject\\grades\\node_modules\\vue-loader\\lib\\index.js","mtime":1684148680698}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBDaGFydCBmcm9tICdjaGFydC5qcy9hdXRvJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTdHVkZW50Q2hhcnQnLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwaWVDaGFydDogbnVsbCwKICAgICAgYmFyQ2hhcnQ6IG51bGwKICAgIH07CiAgfSwKICBhc3luYyBjcmVhdGVkKCkgewogICAgYXdhaXQgdGhpcy5sb2FkRGF0YSgpOwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGNoYXJ0RGF0YTogZnVuY3Rpb24gKCkgewogICAgICBjb25zdCBncmFkZUNvdW50cyA9IHt9OwogICAgICBjb25zdCBzdHVkZW50c0J5R3JhZGUgPSB7fTsKICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuZ3JhZGUuZ3JhZGVzLmZvckVhY2goZ3JhZGUgPT4gewogICAgICAgIGNvbnN0IGdyYWRlVmFsdWUgPSBncmFkZS5ncmFkZTsKICAgICAgICBpZiAoIWdyYWRlQ291bnRzW2dyYWRlVmFsdWVdKSB7CiAgICAgICAgICBncmFkZUNvdW50c1tncmFkZVZhbHVlXSA9IDA7CiAgICAgICAgICBzdHVkZW50c0J5R3JhZGVbZ3JhZGVWYWx1ZV0gPSBbXTsKICAgICAgICB9CiAgICAgICAgZ3JhZGVDb3VudHNbZ3JhZGVWYWx1ZV0rKzsKICAgICAgICBzdHVkZW50c0J5R3JhZGVbZ3JhZGVWYWx1ZV0ucHVzaCh0aGlzLiRzdG9yZS5zdGF0ZS5zdHVkZW50LnN0dWRlbnRzLmdldChncmFkZS5zdHVkZW50Q29kZSkpOwogICAgICB9KTsKICAgICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKGdyYWRlQ291bnRzKS5tYXAoKFtncmFkZVZhbHVlLCBjb3VudF0pID0+ICh7CiAgICAgICAgZ3JhZGVWYWx1ZSwKICAgICAgICBjb3VudCwKICAgICAgICBzdHVkZW50czogc3R1ZGVudHNCeUdyYWRlW2dyYWRlVmFsdWVdCiAgICAgIH0pKTsKICAgIH0sCiAgICBjaGFydERhdGFBbmRPcHRpb25zOiBmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnN0IGNoYXJ0RGF0YSA9IHRoaXMuY2hhcnREYXRhOwogICAgICBjb25zdCBkYXRhID0gewogICAgICAgIGxhYmVsczogY2hhcnREYXRhLm1hcChncmFkZSA9PiBncmFkZS5ncmFkZVZhbHVlKSwKICAgICAgICBkYXRhc2V0czogW3sKICAgICAgICAgIGRhdGE6IGNoYXJ0RGF0YS5tYXAoZ3JhZGUgPT4gZ3JhZGUuY291bnQpLAogICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBbJyNGRjYzODQnLCAnIzM2QTJFQicsICcjRkZDRTU2JywgJyM4REZGMDAnLCAnI0ZGNTczMycsICcjQzQxRTNEJ10KICAgICAgICB9XQogICAgICB9OwogICAgICBjb25zdCBvcHRpb25zID0gewogICAgICAgIHJlc3BvbnNpdmU6IHRydWUsCiAgICAgICAgbWFpbnRhaW5Bc3BlY3RSYXRpbzogZmFsc2UsCiAgICAgICAgcGx1Z2luczogewogICAgICAgICAgdG9vbHRpcDogewogICAgICAgICAgICBjYWxsYmFja3M6IHsKICAgICAgICAgICAgICBsYWJlbDogZnVuY3Rpb24gKHRvb2x0aXBJdGVtKSB7CiAgICAgICAgICAgICAgICBjb25zdCBhcnJheSA9IGNoYXJ0RGF0YVt0b29sdGlwSXRlbS5kYXRhSW5kZXhdLnN0dWRlbnRzLm1hcCgoewogICAgICAgICAgICAgICAgICBmdWxsTmFtZQogICAgICAgICAgICAgICAgfSkgPT4gZnVsbE5hbWUpOwogICAgICAgICAgICAgICAgYXJyYXkudW5zaGlmdCh0b29sdGlwSXRlbS5yYXcpOwogICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKICAgICAgcmV0dXJuIHsKICAgICAgICBkYXRhLAogICAgICAgIG9wdGlvbnMKICAgICAgfTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGxvYWREYXRhKCkgewogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnc3R1ZGVudC9nZXRTdHVkZW50cycpOwogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ3JhZGUvZ2V0Q291cnNlcycpOwogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ3JhZGUvZ2V0R3JhZGVzJyk7CiAgICAgIHRoaXMuY3JlYXRlUGllQ2hhcnQoKTsKICAgICAgdGhpcy5jcmVhdGVCYXJDaGFydCgpOwogICAgfSwKICAgIGNyZWF0ZVBpZUNoYXJ0KCkgewogICAgICB0aGlzLnBpZUNoYXJ0ID0gbmV3IENoYXJ0KHRoaXMuJHJlZnMucGllQ2hhcnQsIHsKICAgICAgICB0eXBlOiAncGllJywKICAgICAgICAuLi50aGlzLmNoYXJ0RGF0YUFuZE9wdGlvbnMKICAgICAgfSk7CiAgICB9LAogICAgY3JlYXRlQmFyQ2hhcnQoKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBkYXRhLAogICAgICAgIG9wdGlvbnMKICAgICAgfSA9IHRoaXMuY2hhcnREYXRhQW5kT3B0aW9uczsKICAgICAgb3B0aW9ucy5wbHVnaW5zLmxlZ2VuZCA9IHsKICAgICAgICBkaXNwbGF5OiBmYWxzZQogICAgICB9OwogICAgICB0aGlzLmJhckNoYXJ0ID0gbmV3IENoYXJ0KHRoaXMuJHJlZnMuYmFyQ2hhcnQsIHsKICAgICAgICB0eXBlOiAnYmFyJywKICAgICAgICBkYXRhLAogICAgICAgIG9wdGlvbnMKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["Chart","name","data","pieChart","barChart","created","loadData","computed","chartData","gradeCounts","studentsByGrade","$store","state","grade","grades","forEach","gradeValue","push","student","students","get","studentCode","Object","entries","map","count","chartDataAndOptions","labels","datasets","backgroundColor","options","responsive","maintainAspectRatio","plugins","tooltip","callbacks","label","tooltipItem","array","dataIndex","fullName","unshift","raw","methods","dispatch","createPieChart","createBarChart","$refs","type","legend","display"],"sources":["src/components/grade/StudentChart.vue"],"sourcesContent":["<template>\r\n  <v-container>\r\n      <v-row>\r\n          <v-col cols=\"6\">\r\n              <v-card>\r\n                  <v-card-title>Круговая диаграмма распределения оценок</v-card-title>\r\n                  <v-card-text>\r\n                      <canvas ref=\"pieChart\" width=\"400\" height=\"400\"></canvas>\r\n                  </v-card-text>\r\n              </v-card>\r\n          </v-col>\r\n          <v-col cols=\"6\">\r\n              <v-card>\r\n                  <v-card-title>Столбчатая диаграмма распределения оценок по курсам</v-card-title>\r\n                  <v-card-text>\r\n                      <canvas ref=\"barChart\" width=\"400\" height=\"400\"></canvas>\r\n                  </v-card-text>\r\n              </v-card>\r\n          </v-col>\r\n      </v-row>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\nimport Chart from 'chart.js/auto'\r\n\r\nexport default {\r\nname: 'StudentChart',\r\ndata () {\r\n  return {\r\n    pieChart: null,\r\n    barChart: null,\r\n  }\r\n},\r\nasync created () {\r\n  await this.loadData()\r\n\r\n},\r\ncomputed: {\r\n  chartData: function () {\r\n    const gradeCounts = {}\r\n    const studentsByGrade = {}\r\n    this.$store.state.grade.grades.forEach((grade) => {\r\n      const gradeValue = grade.grade\r\n      if (!gradeCounts[gradeValue]) {\r\n        gradeCounts[gradeValue] = 0\r\n        studentsByGrade[gradeValue] = []\r\n      }\r\n      gradeCounts[gradeValue]++\r\n      studentsByGrade[gradeValue].push(this.$store.state.student.students.get(grade.studentCode))\r\n    })\r\n\r\n    return Object.entries(gradeCounts).map(([gradeValue, count]) => ({\r\n      gradeValue,\r\n      count,\r\n      students: studentsByGrade[gradeValue],\r\n    }))\r\n  },\r\n  chartDataAndOptions: function () {\r\n    const chartData = this.chartData\r\n    const data = {\r\n      labels: chartData.map((grade) => grade.gradeValue),\r\n      datasets: [\r\n        {\r\n          data: chartData.map((grade) => grade.count),\r\n          backgroundColor: [\r\n            '#FF6384',\r\n            '#36A2EB',\r\n            '#FFCE56',\r\n            '#8DFF00',\r\n            '#FF5733',\r\n            '#C41E3D',\r\n          ],\r\n        },\r\n      ],\r\n    }\r\n    const options = {\r\n      responsive: true,\r\n      maintainAspectRatio: false,\r\n      plugins: {\r\n        tooltip: {\r\n          callbacks: {\r\n            label: function (tooltipItem) {\r\n              const array = chartData[tooltipItem.dataIndex].students.map(({ fullName }) => fullName)\r\n              array.unshift(tooltipItem.raw)\r\n              return array\r\n            }\r\n          },\r\n        },\r\n      }\r\n    }\r\n\r\n    return { data, options }\r\n  }\r\n},\r\nmethods: {\r\n  async loadData () {\r\n    await this.$store.dispatch('student/getStudents')\r\n    await this.$store.dispatch('grade/getCourses')\r\n    await this.$store.dispatch('grade/getGrades')\r\n\r\n    this.createPieChart()\r\n    this.createBarChart()\r\n  },\r\n\r\n  createPieChart () {\r\n    this.pieChart = new Chart(this.$refs.pieChart, {\r\n      type: 'pie',\r\n      ...this.chartDataAndOptions,\r\n    })\r\n  },\r\n  createBarChart () {\r\n    const { data, options } = this.chartDataAndOptions\r\n    options.plugins.legend = {\r\n      display: false\r\n    }\r\n    this.barChart = new Chart(this.$refs.barChart, {\r\n      type: 'bar',\r\n      data,\r\n      options,\r\n    })\r\n  },\r\n},\r\n}\r\n</script>\r\n"],"mappings":";AAwBA,OAAAA,KAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,QAAA;MACAC,QAAA;IACA;EACA;EACA,MAAAC,QAAA;IACA,WAAAC,QAAA;EAEA;EACAC,QAAA;IACAC,SAAA,WAAAA,CAAA;MACA,MAAAC,WAAA;MACA,MAAAC,eAAA;MACA,KAAAC,MAAA,CAAAC,KAAA,CAAAC,KAAA,CAAAC,MAAA,CAAAC,OAAA,CAAAF,KAAA;QACA,MAAAG,UAAA,GAAAH,KAAA,CAAAA,KAAA;QACA,KAAAJ,WAAA,CAAAO,UAAA;UACAP,WAAA,CAAAO,UAAA;UACAN,eAAA,CAAAM,UAAA;QACA;QACAP,WAAA,CAAAO,UAAA;QACAN,eAAA,CAAAM,UAAA,EAAAC,IAAA,MAAAN,MAAA,CAAAC,KAAA,CAAAM,OAAA,CAAAC,QAAA,CAAAC,GAAA,CAAAP,KAAA,CAAAQ,WAAA;MACA;MAEA,OAAAC,MAAA,CAAAC,OAAA,CAAAd,WAAA,EAAAe,GAAA,GAAAR,UAAA,EAAAS,KAAA;QACAT,UAAA;QACAS,KAAA;QACAN,QAAA,EAAAT,eAAA,CAAAM,UAAA;MACA;IACA;IACAU,mBAAA,WAAAA,CAAA;MACA,MAAAlB,SAAA,QAAAA,SAAA;MACA,MAAAN,IAAA;QACAyB,MAAA,EAAAnB,SAAA,CAAAgB,GAAA,CAAAX,KAAA,IAAAA,KAAA,CAAAG,UAAA;QACAY,QAAA,GACA;UACA1B,IAAA,EAAAM,SAAA,CAAAgB,GAAA,CAAAX,KAAA,IAAAA,KAAA,CAAAY,KAAA;UACAI,eAAA,GACA,WACA,WACA,WACA,WACA,WACA;QAEA;MAEA;MACA,MAAAC,OAAA;QACAC,UAAA;QACAC,mBAAA;QACAC,OAAA;UACAC,OAAA;YACAC,SAAA;cACAC,KAAA,WAAAA,CAAAC,WAAA;gBACA,MAAAC,KAAA,GAAA9B,SAAA,CAAA6B,WAAA,CAAAE,SAAA,EAAApB,QAAA,CAAAK,GAAA;kBAAAgB;gBAAA,MAAAA,QAAA;gBACAF,KAAA,CAAAG,OAAA,CAAAJ,WAAA,CAAAK,GAAA;gBACA,OAAAJ,KAAA;cACA;YACA;UACA;QACA;MACA;MAEA;QAAApC,IAAA;QAAA4B;MAAA;IACA;EACA;EACAa,OAAA;IACA,MAAArC,SAAA;MACA,WAAAK,MAAA,CAAAiC,QAAA;MACA,WAAAjC,MAAA,CAAAiC,QAAA;MACA,WAAAjC,MAAA,CAAAiC,QAAA;MAEA,KAAAC,cAAA;MACA,KAAAC,cAAA;IACA;IAEAD,eAAA;MACA,KAAA1C,QAAA,OAAAH,KAAA,MAAA+C,KAAA,CAAA5C,QAAA;QACA6C,IAAA;QACA,QAAAtB;MACA;IACA;IACAoB,eAAA;MACA;QAAA5C,IAAA;QAAA4B;MAAA,SAAAJ,mBAAA;MACAI,OAAA,CAAAG,OAAA,CAAAgB,MAAA;QACAC,OAAA;MACA;MACA,KAAA9C,QAAA,OAAAJ,KAAA,MAAA+C,KAAA,CAAA3C,QAAA;QACA4C,IAAA;QACA9C,IAAA;QACA4B;MACA;IACA;EACA;AACA"}]}